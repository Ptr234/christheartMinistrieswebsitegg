import{R as m,r as p,j as a}from"./index-D0pxIs8-.js";import{M as d,T as f,a as h,P as g,u as l,L as c}from"./leaflet-DWW7oOxF.js";const u=c.divIcon({className:"map-pin",html:'<div class="map-pin-inner"><span class="map-pin-cross">✟</span></div>',iconSize:[30,40],iconAnchor:[15,40],popupAnchor:[0,-40]}),x=c.divIcon({className:"map-pin map-pin-selected",html:'<div class="map-pin-inner"><span class="map-pin-cross">✟</span></div>',iconSize:[36,48],iconAnchor:[18,48],popupAnchor:[0,-48]});c.Marker.prototype.options.icon=u;function v({branches:o,selectedId:r,markerRefs:e}){const i=l();return p.useEffect(()=>{if(r)return;const t=o.filter(n=>n.lat!==0||n.lng!==0);if(t.length!==0)if(t.length===1)i.flyTo([t[0].lat,t[0].lng],13,{duration:.5});else{const n=c.latLngBounds(t.map(s=>[s.lat,s.lng]));i.fitBounds(n,{padding:[40,40],maxZoom:14,animate:!0})}},[o,i,r]),p.useEffect(()=>{if(!r)return;const t=o.find(n=>n.id===r);!t||t.lat===0&&t.lng===0||(i.flyTo([t.lat,t.lng],15,{duration:.8}),setTimeout(()=>{const n=e.current[r];n?.openPopup&&n.openPopup()},900))},[r,o,i,e]),null}try{localStorage.removeItem("branchCoords")}catch{}function j(){const o=l();return p.useEffect(()=>{const r=setTimeout(()=>o.invalidateSize(),250);return()=>clearTimeout(r)},[o]),null}function S({branches:o,selectedId:r}){const e=m.useRef({}),i=p.useMemo(()=>o.filter(n=>n.lat!==0||n.lng!==0),[o]),t=[.3136,32.5811];return a.jsxs(d,{id:"branch-map",center:t,zoom:7,style:{height:"460px",width:"100%",borderRadius:"var(--radius-xl)",marginBottom:"1rem"},children:[a.jsx(f,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19,crossOrigin:""}),a.jsx(j,{}),a.jsx(v,{branches:o,selectedId:r,markerRefs:e}),i.map(n=>a.jsx(h,{position:[n.lat,n.lng],icon:r===n.id?x:u,ref:s=>{s&&(e.current[n.id]=s)},children:a.jsxs(g,{children:[a.jsx("strong",{children:n.name}),a.jsx("div",{style:{fontSize:"0.85em",color:"#666",marginTop:4},children:n.address&&n.address!=="Online"?n.address:n.city}),n.phone&&a.jsx("div",{style:{fontSize:"0.85em",marginTop:2},children:n.phone})]})},n.id))]})}export{S as default};
