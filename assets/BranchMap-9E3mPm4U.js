import{R as m,r as c,j as a}from"./index-BpDo7nEO.js";import{M as d,T as h,a as f,P as g,u,L as p}from"./leaflet-2ezczUGQ.js";const l=p.divIcon({className:"map-pin",html:'<div class="map-pin-inner"><span class="map-pin-cross">✟</span></div>',iconSize:[30,40],iconAnchor:[15,40],popupAnchor:[0,-40]}),v=p.divIcon({className:"map-pin map-pin-selected",html:'<div class="map-pin-inner"><span class="map-pin-cross">✟</span></div>',iconSize:[36,48],iconAnchor:[18,48],popupAnchor:[0,-48]});p.Marker.prototype.options.icon=l;function x({branches:t,selectedId:o,markerRefs:i}){const r=u();return c.useEffect(()=>{if(o)return;const e=t.filter(n=>n.lat!==0||n.lng!==0);if(e.length!==0)if(e.length===1)r.flyTo([e[0].lat,e[0].lng],13,{duration:.5});else{const n=p.latLngBounds(e.map(s=>[s.lat,s.lng]));r.fitBounds(n,{padding:[40,40],maxZoom:14,animate:!0})}},[t,r,o]),c.useEffect(()=>{if(!o)return;const e=t.find(n=>n.id===o);!e||e.lat===0&&e.lng===0||(r.flyTo([e.lat,e.lng],15,{duration:.8}),setTimeout(()=>{const n=i.current[o];n?.openPopup&&n.openPopup()},900))},[o,t,r,i]),null}try{localStorage.removeItem("branchCoords")}catch{}function T(){const t=u();return c.useEffect(()=>{const o=setTimeout(()=>t.invalidateSize(),250);return()=>clearTimeout(o)},[t]),null}function j(){const t=u();return c.useEffect(()=>{if(!("ontouchstart"in window||navigator.maxTouchPoints>0))return;t.dragging.disable();const i=t.getContainer();let r=0;const e=s=>{r=s.touches.length,r>=2&&t.dragging.enable()},n=()=>{r=0,setTimeout(()=>t.dragging.disable(),100)};return i.addEventListener("touchstart",e,{passive:!0}),i.addEventListener("touchend",n,{passive:!0}),()=>{i.removeEventListener("touchstart",e),i.removeEventListener("touchend",n)}},[t]),null}function S({branches:t,selectedId:o}){const i=m.useRef({}),r=c.useMemo(()=>t.filter(n=>n.lat!==0||n.lng!==0),[t]),e=[.3136,32.5811];return a.jsxs(d,{id:"branch-map",center:e,zoom:7,scrollWheelZoom:!1,style:{height:"460px",width:"100%",borderRadius:"var(--radius-xl)",marginBottom:"1rem"},children:[a.jsx(h,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19,crossOrigin:""}),a.jsx(T,{}),a.jsx(j,{}),a.jsx(x,{branches:t,selectedId:o,markerRefs:i}),r.map(n=>a.jsx(f,{position:[n.lat,n.lng],icon:o===n.id?v:l,ref:s=>{s&&(i.current[n.id]=s)},children:a.jsxs(g,{children:[a.jsx("strong",{children:n.name}),a.jsx("div",{style:{fontSize:"0.85em",color:"#666",marginTop:4},children:n.address&&n.address!=="Online"?n.address:n.city}),n.phone&&a.jsx("div",{style:{fontSize:"0.85em",marginTop:2},children:n.phone})]})},n.id))]})}export{S as default};
