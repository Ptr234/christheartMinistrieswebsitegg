import{r as l,j as n}from"./index-omapKN3Q.js";import{M as j,T as v,a as y,P as S,u as d,L as f}from"./leaflet-CCILxpM0.js";const M=f.divIcon({className:"map-pin",html:'<div class="map-pin-inner"><span class="map-pin-cross">✟</span></div>',iconSize:[30,40],iconAnchor:[15,40],popupAnchor:[0,-40]});f.Marker.prototype.options.icon=M;function b({lat:t,lng:r,zoom:e}){const a=d();return l.useEffect(()=>{a.flyTo([t,r],e,{duration:.5})},[t,r,e,a]),null}function w(){const t=d();return l.useEffect(()=>{const r=setTimeout(()=>t.invalidateSize(),250);return()=>clearTimeout(r)},[t]),null}async function C(t){const r="locationMapCache",e=JSON.parse(localStorage.getItem(r)||"{}");if(e[t])return e[t];try{const a=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(t)}&limit=1`,o=await(await fetch(a,{headers:{Accept:"application/json"}})).json();if(o&&o[0]){const s={lat:parseFloat(o[0].lat),lng:parseFloat(o[0].lon)};return e[t]=s,localStorage.setItem(r,JSON.stringify(e)),s}}catch{}return null}function E({address:t,label:r,height:e="250px",zoom:a=15,lat:c,lng:o}){const s=c!=null&&o!=null&&(c!==0||o!==0),[i,m]=l.useState(s?{lat:c,lng:o}:null),[h,g]=l.useState(!s);if(l.useEffect(()=>{if(s)return;let u=!0;return C(t).then(x=>{u&&(m(x),g(!1))}),()=>{u=!1}},[t,s]),h)return n.jsx("div",{style:{height:e,display:"flex",alignItems:"center",justifyContent:"center",background:"var(--purple-50)",borderRadius:"var(--radius-lg)",color:"var(--text-light)"},children:"Loading map..."});if(!i)return n.jsx("div",{style:{height:e,display:"flex",alignItems:"center",justifyContent:"center",background:"var(--purple-50)",borderRadius:"var(--radius-lg)",color:"var(--text-light)",fontSize:"0.85rem"},children:"Map unavailable for this location"});const p=[i.lat,i.lng];return n.jsxs(j,{center:p,zoom:a,style:{height:e,width:"100%",borderRadius:"var(--radius-lg)",overflow:"hidden"},scrollWheelZoom:!1,children:[n.jsx(v,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19,crossOrigin:""}),n.jsx(w,{}),n.jsx(b,{lat:i.lat,lng:i.lng,zoom:a}),n.jsx(y,{position:p,children:n.jsxs(S,{children:[n.jsx("strong",{children:r}),n.jsx("div",{children:t})]})})]})}export{E as default};
